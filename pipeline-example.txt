pipeline {
 
  environment {
       IBM_ACCESS_KEY_ID     = credentials('ibmuser')
        IBM_SECRET_ACCESS_KEY = credentials('ibmkey')
    }
 
  agent any
 
  stages {
 


  stage('Checkout Source') {
      
      steps {
        git 'https://github.com/eduardojc-met/testjson.git'
      }
    }
 

    stage('Get & use Configuration') {
      
      steps {
        script{


def json = readJSON file: 'exmaple2.json'             
json.each { myData ->
 
 def nameActual=myData.projectName.toString()

if(nameActual == "backend") {
            
            def archivoconf=myData.stepsFile.toString()

def pipelineB = load archivoconf
           
bat "IF not exist ${nameActual} (mkdir ${nameActual})"

dir("${nameActual}") {
pipelineB.test("%IBM_ACCESS_KEY_ID%","%IBM_SECRET_ACCESS_KEY%")
}

           }
       
  

        }
  }
   



}
}
}
}
